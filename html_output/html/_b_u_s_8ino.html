<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: BUS/BUS.ino File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_7d4d908c8a0b94e058eced284796c5b3.html">BUS</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">BUS.ino File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;Adafruit_MPU6050.h&gt;</code><br />
<code>#include &lt;SPI.h&gt;</code><br />
<code>#include &lt;WiFi.h&gt;</code><br />
<code>#include &lt;Wire.h&gt;</code><br />
<code>#include &lt;esp_now.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtag_m_e_s_s_a_g_e.html">tagMESSAGE</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for sending and receiving data.  <a href="structtag_m_e_s_s_a_g_e.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_m_e_s_s_a_g_e___r_e_c_v.html">MESSAGE_RECV</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a8994190f393eaf34936360685debb15e"><td class="memItemLeft" align="right" valign="top"><a id="a8994190f393eaf34936360685debb15e" name="a8994190f393eaf34936360685debb15e"></a>
typedef struct <a class="el" href="structtag_m_e_s_s_a_g_e.html">tagMESSAGE</a>&#160;</td><td class="memItemRight" valign="bottom"><b>MESSAGE</b></td></tr>
<tr class="separator:a8994190f393eaf34936360685debb15e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a89e7e081914e7a05eb2be3f45ba8587d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#a89e7e081914e7a05eb2be3f45ba8587d">onDataRecv</a> (const uint8_t *pucMac, const uint8_t *pucIncomingData, int iLen)</td></tr>
<tr class="memdesc:a89e7e081914e7a05eb2be3f45ba8587d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function that is executed when data is received.  <br /></td></tr>
<tr class="separator:a89e7e081914e7a05eb2be3f45ba8587d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30eeb6b1193798e442163fc81e52c729"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#a30eeb6b1193798e442163fc81e52c729">send_data_service</a> (int iIndex)</td></tr>
<tr class="memdesc:a30eeb6b1193798e442163fc81e52c729"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a service message to the bus stops.  <br /></td></tr>
<tr class="separator:a30eeb6b1193798e442163fc81e52c729"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f6799cc71dd2e1b8819f1980b317329"><td class="memItemLeft" align="right" valign="top">void IRAM_ATTR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#a2f6799cc71dd2e1b8819f1980b317329">handleInterrupt</a> ()</td></tr>
<tr class="memdesc:a2f6799cc71dd2e1b8819f1980b317329"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interrupt service routine for handling button press.  <br /></td></tr>
<tr class="separator:a2f6799cc71dd2e1b8819f1980b317329"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eee811cfe0d4a8ad6ddb6e6b6ec6027"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#a7eee811cfe0d4a8ad6ddb6e6b6ec6027">OnDataSent</a> (const uint8_t *pucMacAddr, esp_now_send_status_t eStatus)</td></tr>
<tr class="memdesc:a7eee811cfe0d4a8ad6ddb6e6b6ec6027"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function that is executed when data is sent.  <br /></td></tr>
<tr class="separator:a7eee811cfe0d4a8ad6ddb6e6b6ec6027"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dfd9b79bc5a37d7df40207afbc5431f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#a7dfd9b79bc5a37d7df40207afbc5431f">setup</a> (void)</td></tr>
<tr class="memdesc:a7dfd9b79bc5a37d7df40207afbc5431f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup function for the Arduino sketch.  <br /></td></tr>
<tr class="separator:a7dfd9b79bc5a37d7df40207afbc5431f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaeab7c376f23efb8907c7ba487a49f9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#abaeab7c376f23efb8907c7ba487a49f9">get_rssi</a> (int iBusStopIndex)</td></tr>
<tr class="memdesc:abaeab7c376f23efb8907c7ba487a49f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the RSSI value for a specific bus stop.  <br /></td></tr>
<tr class="separator:abaeab7c376f23efb8907c7ba487a49f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9ead55967e581c2e6c25243e59add5b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#af9ead55967e581c2e6c25243e59add5b">send_data</a> (int iMessageIndex, int iBusStopIndex)</td></tr>
<tr class="memdesc:af9ead55967e581c2e6c25243e59add5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a data message to the bus stops.  <br /></td></tr>
<tr class="separator:af9ead55967e581c2e6c25243e59add5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63ab5a55c2e373bc0465d56ee4231f09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#a63ab5a55c2e373bc0465d56ee4231f09">send_data_halt</a> (int iMessageIndex, int iBusStopIndex)</td></tr>
<tr class="memdesc:a63ab5a55c2e373bc0465d56ee4231f09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a halt message to the bus stops.  <br /></td></tr>
<tr class="separator:a63ab5a55c2e373bc0465d56ee4231f09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe461d27b9c48d5921c00d521181f12f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#afe461d27b9c48d5921c00d521181f12f">loop</a> ()</td></tr>
<tr class="memdesc:afe461d27b9c48d5921c00d521181f12f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main loop function for the Arduino sketch.  <br /></td></tr>
<tr class="separator:afe461d27b9c48d5921c00d521181f12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a47450f2dff514e8a4685176f53e40b5d"><td class="memItemLeft" align="right" valign="top">Adafruit_MPU6050&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#a47450f2dff514e8a4685176f53e40b5d">g_mpuSensor</a></td></tr>
<tr class="separator:a47450f2dff514e8a4685176f53e40b5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00d089c7f954971aff61854f59726ac5"><td class="memItemLeft" align="right" valign="top">esp_now_peer_info_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#a00d089c7f954971aff61854f59726ac5">g_peerInfoFirst</a></td></tr>
<tr class="separator:a00d089c7f954971aff61854f59726ac5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9e179b964924e1225b3a0269bfbade7"><td class="memItemLeft" align="right" valign="top">esp_now_peer_info_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#ae9e179b964924e1225b3a0269bfbade7">g_peerInfoSecond</a></td></tr>
<tr class="separator:ae9e179b964924e1225b3a0269bfbade7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5c515a9350579a4bfb378e163662352"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#ad5c515a9350579a4bfb378e163662352">g_arrBroadcastAddress</a> [2][6]</td></tr>
<tr class="memdesc:ad5c515a9350579a4bfb378e163662352"><td class="mdescLeft">&#160;</td><td class="mdescRight">MAC addresses for broadcast.  <br /></td></tr>
<tr class="separator:ad5c515a9350579a4bfb378e163662352"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cf028b17bba6c35ad265d25769ac9d4"><td class="memItemLeft" align="right" valign="top">String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#a1cf028b17bba6c35ad265d25769ac9d4">g_arrSSID</a> [2]</td></tr>
<tr class="memdesc:a1cf028b17bba6c35ad265d25769ac9d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">SSIDs of the bus stops.  <br /></td></tr>
<tr class="separator:a1cf028b17bba6c35ad265d25769ac9d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03e68a21c3ce3f02146e6a4d49b1dadb"><td class="memItemLeft" align="right" valign="top"><a id="a03e68a21c3ce3f02146e6a4d49b1dadb" name="a03e68a21c3ce3f02146e6a4d49b1dadb"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>g_iVertex</b> = 0</td></tr>
<tr class="memdesc:a03e68a21c3ce3f02146e6a4d49b1dadb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vertex index. <br /></td></tr>
<tr class="separator:a03e68a21c3ce3f02146e6a4d49b1dadb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c323722998f3f30a38c361d5d4eb1ab"><td class="memItemLeft" align="right" valign="top"><a id="a9c323722998f3f30a38c361d5d4eb1ab" name="a9c323722998f3f30a38c361d5d4eb1ab"></a>
const int&#160;</td><td class="memItemRight" valign="bottom"><b>g_iButtonPin</b> = 0</td></tr>
<tr class="memdesc:a9c323722998f3f30a38c361d5d4eb1ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pin number for the button. <br /></td></tr>
<tr class="separator:a9c323722998f3f30a38c361d5d4eb1ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afaae0c277a80214e1fba498a35e66399"><td class="memItemLeft" align="right" valign="top"><a id="afaae0c277a80214e1fba498a35e66399" name="afaae0c277a80214e1fba498a35e66399"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>g_iOOSFlag</b> = 0</td></tr>
<tr class="memdesc:afaae0c277a80214e1fba498a35e66399"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag for out of service status. <br /></td></tr>
<tr class="separator:afaae0c277a80214e1fba498a35e66399"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab33df07f2a093b59104993713d43aa23"><td class="memItemLeft" align="right" valign="top"><a id="ab33df07f2a093b59104993713d43aa23" name="ab33df07f2a093b59104993713d43aa23"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>g_iHopeFlag</b> = 0</td></tr>
<tr class="memdesc:ab33df07f2a093b59104993713d43aa23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag for hope status. <br /></td></tr>
<tr class="separator:ab33df07f2a093b59104993713d43aa23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1c617e6f57488317c234eddb7e207a1"><td class="memItemLeft" align="right" valign="top">volatile bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#ac1c617e6f57488317c234eddb7e207a1">g_bButtonPressed</a></td></tr>
<tr class="memdesc:ac1c617e6f57488317c234eddb7e207a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to indicate if the button is pressed.  <br /></td></tr>
<tr class="separator:ac1c617e6f57488317c234eddb7e207a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7820e8796c8d9972f7afa730d0b64e9a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b_u_s_8ino.html#a7820e8796c8d9972f7afa730d0b64e9a">g_bPassengerFlag</a></td></tr>
<tr class="memdesc:a7820e8796c8d9972f7afa730d0b64e9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag for passenger status.  <br /></td></tr>
<tr class="separator:a7820e8796c8d9972f7afa730d0b64e9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1fd82bce4a1f7e765d7d19c94daac13"><td class="memItemLeft" align="right" valign="top"><a id="ae1fd82bce4a1f7e765d7d19c94daac13" name="ae1fd82bce4a1f7e765d7d19c94daac13"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>g_iHaltFlag</b> = 0</td></tr>
<tr class="memdesc:ae1fd82bce4a1f7e765d7d19c94daac13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag for halt status. <br /></td></tr>
<tr class="separator:ae1fd82bce4a1f7e765d7d19c94daac13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fa21e4855ee7c94a755cf91af6ce9b0"><td class="memItemLeft" align="right" valign="top"><a id="a4fa21e4855ee7c94a755cf91af6ce9b0" name="a4fa21e4855ee7c94a755cf91af6ce9b0"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>g_iLatchFlag</b> = 0</td></tr>
<tr class="memdesc:a4fa21e4855ee7c94a755cf91af6ce9b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag for latch status. <br /></td></tr>
<tr class="separator:a4fa21e4855ee7c94a755cf91af6ce9b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb1ff61df3846cda82a38cd6f090e696"><td class="memItemLeft" align="right" valign="top"><a id="afb1ff61df3846cda82a38cd6f090e696" name="afb1ff61df3846cda82a38cd6f090e696"></a>
<a class="el" href="structtag_m_e_s_s_a_g_e.html">MESSAGE</a>&#160;</td><td class="memItemRight" valign="bottom"><b>g_myData</b></td></tr>
<tr class="memdesc:afb1ff61df3846cda82a38cd6f090e696"><td class="mdescLeft">&#160;</td><td class="mdescRight">Instance of MESSAGE to hold data. <br /></td></tr>
<tr class="separator:afb1ff61df3846cda82a38cd6f090e696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a385dcf437d328e3c38eed3493bbb01b8"><td class="memItemLeft" align="right" valign="top"><a id="a385dcf437d328e3c38eed3493bbb01b8" name="a385dcf437d328e3c38eed3493bbb01b8"></a>
const int&#160;</td><td class="memItemRight" valign="bottom"><b>g_iLedPin</b> = 2</td></tr>
<tr class="memdesc:a385dcf437d328e3c38eed3493bbb01b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pin number for the LED. <br /></td></tr>
<tr class="separator:a385dcf437d328e3c38eed3493bbb01b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4728278f4240f95c00c363ab0210d368"><td class="memItemLeft" align="right" valign="top"><a id="a4728278f4240f95c00c363ab0210d368" name="a4728278f4240f95c00c363ab0210d368"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>g_iAvgSample</b> = 0</td></tr>
<tr class="separator:a4728278f4240f95c00c363ab0210d368"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ab83db113e0fb36707b0e07da10e183"><td class="memItemLeft" align="right" valign="top"><a id="a5ab83db113e0fb36707b0e07da10e183" name="a5ab83db113e0fb36707b0e07da10e183"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>g_arrSamples</b> [10]</td></tr>
<tr class="separator:a5ab83db113e0fb36707b0e07da10e183"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="abaeab7c376f23efb8907c7ba487a49f9" name="abaeab7c376f23efb8907c7ba487a49f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaeab7c376f23efb8907c7ba487a49f9">&#9670;&#160;</a></span>get_rssi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_rssi </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iBusStopIndex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the RSSI value for a specific bus stop. </p>
<p>This function scans the networks and returns the RSSI value for a specific bus stop.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iBusStopIndex</td><td>The index of the bus stop. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The RSSI value. Returns 0 if the RSSI is greater than or equal to -50, 2 if the SSID matches the bus stop, and 1 otherwise. </dd></dl>

</div>
</div>
<a id="a2f6799cc71dd2e1b8819f1980b317329" name="a2f6799cc71dd2e1b8819f1980b317329"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f6799cc71dd2e1b8819f1980b317329">&#9670;&#160;</a></span>handleInterrupt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IRAM_ATTR handleInterrupt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interrupt service routine for handling button press. </p>
<p>This function is called when an interrupt is triggered. It toggles the g_bButtonPressed flag. </p>

</div>
</div>
<a id="afe461d27b9c48d5921c00d521181f12f" name="afe461d27b9c48d5921c00d521181f12f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe461d27b9c48d5921c00d521181f12f">&#9670;&#160;</a></span>loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main loop function for the Arduino sketch. </p>
<p>This function continuously checks if the button is pressed and sends a service message if it is. It also checks if a passenger signal is received and turns on the LED if it is. It calculates the average sample of the accelerometer readings and determines if the bus is moving or stopped based on the average. If the bus is moving, it sends a "BUS MOVING" message. If the bus is stopped, it sends a "BUS STOPPED" message. It also checks the RSSI values and sends a halt message if the bus is near a bus stop. </p>

</div>
</div>
<a id="a89e7e081914e7a05eb2be3f45ba8587d" name="a89e7e081914e7a05eb2be3f45ba8587d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89e7e081914e7a05eb2be3f45ba8587d">&#9670;&#160;</a></span>onDataRecv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void onDataRecv </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pucMac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pucIncomingData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function that is executed when data is received. </p>
<p>This function handles the incoming data and sets the passenger flag to true if a message is received.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pucMac</td><td>The MAC address of the sender. </td></tr>
    <tr><td class="paramname">pucIncomingData</td><td>The incoming data. </td></tr>
    <tr><td class="paramname">iLen</td><td>The length of the incoming data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7eee811cfe0d4a8ad6ddb6e6b6ec6027" name="a7eee811cfe0d4a8ad6ddb6e6b6ec6027"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eee811cfe0d4a8ad6ddb6e6b6ec6027">&#9670;&#160;</a></span>OnDataSent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OnDataSent </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pucMacAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">esp_now_send_status_t&#160;</td>
          <td class="paramname"><em>eStatus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function that is executed when data is sent. </p>
<p>This function prints the status of the last packet sent. It prints "Delivery Success" if the packet was sent successfully, otherwise it prints "Delivery Fail".</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pucMacAddr</td><td>The MAC address of the receiver. </td></tr>
    <tr><td class="paramname">eStatus</td><td>The status of the send operation. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af9ead55967e581c2e6c25243e59add5b" name="af9ead55967e581c2e6c25243e59add5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9ead55967e581c2e6c25243e59add5b">&#9670;&#160;</a></span>send_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void send_data </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iMessageIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iBusStopIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a data message to the bus stops. </p>
<p>This function sends a data message (either "BUS
STOPPED!" or "BUS STARTED!") to the bus stops.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iMessageIndex</td><td>The index of the message to be sent. If iMessageIndex is 0, "BUS STOPPED!" is sent. Otherwise, "BUS STARTED!" is sent. </td></tr>
    <tr><td class="paramname">iBusStopIndex</td><td>The index of the bus stop to send the message to. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a63ab5a55c2e373bc0465d56ee4231f09" name="a63ab5a55c2e373bc0465d56ee4231f09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63ab5a55c2e373bc0465d56ee4231f09">&#9670;&#160;</a></span>send_data_halt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void send_data_halt </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iMessageIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iBusStopIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a halt message to the bus stops. </p>
<p>This function sends a halt message (either "BUS HALTED" or "BUS MOVING") to the bus stops.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iMessageIndex</td><td>The index of the message to be sent. If iMessageIndex is 0, "BUS HALTED" is sent. Otherwise, "BUS MOVING" is sent. </td></tr>
    <tr><td class="paramname">iBusStopIndex</td><td>The index of the bus stop to send the message to. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a30eeb6b1193798e442163fc81e52c729" name="a30eeb6b1193798e442163fc81e52c729"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30eeb6b1193798e442163fc81e52c729">&#9670;&#160;</a></span>send_data_service()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void send_data_service </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iIndex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a service message to the bus stops. </p>
<p>This function sends a service message (either "BUS OOS" or "BUS NOOS") to the bus stops.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iIndex</td><td>The index of the message to be sent. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7dfd9b79bc5a37d7df40207afbc5431f" name="a7dfd9b79bc5a37d7df40207afbc5431f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dfd9b79bc5a37d7df40207afbc5431f">&#9670;&#160;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup function for the Arduino sketch. </p>
<p>This function initializes the serial communication, sets the button pin as input and attaches an interrupt to it, initializes the MPU6050 sensor, sets the accelerometer range and filter bandwidth, initializes ESP-NOW, registers the send callback function, adds peers for ESP-NOW communication, registers the receive callback function, and sets the LED pin as output. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad5c515a9350579a4bfb378e163662352" name="ad5c515a9350579a4bfb378e163662352"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5c515a9350579a4bfb378e163662352">&#9670;&#160;</a></span>g_arrBroadcastAddress</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t g_arrBroadcastAddress[2][6]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    {0xEC, 0x64, 0xC9, 0x86, 0x13, 0xC0},</div>
<div class="line">    {0xEC, 0x64, 0xC9, 0x82, 0x7E,</div>
<div class="line">     0x10}}</div>
</div><!-- fragment -->
<p>MAC addresses for broadcast. </p>

</div>
</div>
<a id="a1cf028b17bba6c35ad265d25769ac9d4" name="a1cf028b17bba6c35ad265d25769ac9d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cf028b17bba6c35ad265d25769ac9d4">&#9670;&#160;</a></span>g_arrSSID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">String g_arrSSID[2]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    <span class="stringliteral">&quot;BUS_STOP_A&quot;</span>, <span class="stringliteral">&quot;BUS_STOP_B&quot;</span>}</div>
</div><!-- fragment -->
<p>SSIDs of the bus stops. </p>

</div>
</div>
<a id="ac1c617e6f57488317c234eddb7e207a1" name="ac1c617e6f57488317c234eddb7e207a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1c617e6f57488317c234eddb7e207a1">&#9670;&#160;</a></span>g_bButtonPressed</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile bool g_bButtonPressed</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">    <span class="keyword">false</span></div>
</div><!-- fragment -->
<p>Flag to indicate if the button is pressed. </p>

</div>
</div>
<a id="a7820e8796c8d9972f7afa730d0b64e9a" name="a7820e8796c8d9972f7afa730d0b64e9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7820e8796c8d9972f7afa730d0b64e9a">&#9670;&#160;</a></span>g_bPassengerFlag</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool g_bPassengerFlag</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">    <span class="keyword">false</span></div>
</div><!-- fragment -->
<p>Flag for passenger status. </p>

</div>
</div>
<a id="a47450f2dff514e8a4685176f53e40b5d" name="a47450f2dff514e8a4685176f53e40b5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47450f2dff514e8a4685176f53e40b5d">&#9670;&#160;</a></span>g_mpuSensor</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Adafruit_MPU6050 g_mpuSensor</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create an instance of the MPU6050 sensor </p>

</div>
</div>
<a id="a00d089c7f954971aff61854f59726ac5" name="a00d089c7f954971aff61854f59726ac5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00d089c7f954971aff61854f59726ac5">&#9670;&#160;</a></span>g_peerInfoFirst</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_now_peer_info_t g_peerInfoFirst</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Peer information for ESP-NOW communication with the first peer </p>

</div>
</div>
<a id="ae9e179b964924e1225b3a0269bfbade7" name="ae9e179b964924e1225b3a0269bfbade7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9e179b964924e1225b3a0269bfbade7">&#9670;&#160;</a></span>g_peerInfoSecond</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_now_peer_info_t g_peerInfoSecond</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Peer information for ESP-NOW communication with the second peer </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
